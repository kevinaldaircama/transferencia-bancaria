<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generador VPS</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f1f2f6;
    }
    .container {
      max-width: 500px;
      margin: 40px auto;
      padding: 20px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #2f3542;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
    }
    input, select, button {
      width: 100%;
      margin-top: 5px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ced6e0;
      font-size: 16px;
    }
    button {
      background-color: #0984e3;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: #74b9ff;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 12px;
      max-width: 600px;
      width: 90%;
      position: relative;
      animation: fadeIn 0.3s ease;
      max-height: 80vh;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    .close {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 28px;
      cursor: pointer;
      color: #e74c3c;
    }

    @keyframes fadeIn {
      from {opacity: 0; transform: scale(0.9);}
      to {opacity: 1; transform: scale(1);}
    }

    .spinner {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #3498db;
      border-radius: 50%;
      width: 50px; height: 50px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Generador de VPS</h1>
    <form id="vpsForm">
      <label for="ubicacion">Ubicación:</label>
      <select id="ubicacion" required>
        <option value="">Seleccionar</option>
        <option value="estados-unidos">Estados Unidos</option>
        <option value="peru">Perú</option>
        <option value="aleatorio">Aleatorio</option>
      </select>

      <label>Usuario:</label>
      <input type="text" id="usuario" required>

      <label>Contraseña:</label>
      <input type="text" id="password" required>

      <label>Días de duración (máx. 30):</label>
      <input type="number" id="dias" max="30" required>

      <label>Límite de conexión (máx. 500):</label>
      <input type="number" id="limite" max="500" required>

      <button type="submit">Generar VPS</button>
    </form>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <span class="close" onclick="cerrarModal()">&times;</span>
      <div id="modal-body">Cargando...</div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBMw3Zbb-rcXoOXlT1U-WWN1N4L4bk1aCk",
      authDomain: "sistema-27b31.firebaseapp.com",
      projectId: "sistema-27b31",
      storageBucket: "sistema-27b31.appspot.com",
      messagingSenderId: "32031316083",
      appId: "1:32031316083:web:32cef8736c5a77fbb9f206",
      measurementId: "G-JSXX8PF8BC"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let uid = null;

    auth.onAuthStateChanged(user => {
      if (user) {
        uid = user.uid;
      } else {
        window.location.href = "index.html"; // Redirigir si no ha iniciado sesión
      }
    });

    const form = document.getElementById("vpsForm");
    const modal = document.getElementById("modal");
    const modalBody = document.getElementById("modal-body");

    function mostrarModal(contenido) {
      modalBody.innerHTML = contenido;
      modal.style.display = "flex";
    }

    function cerrarModal() {
      modal.style.display = "none";
    }

    async function descontarCreditos(costo) {
      const ref = db.collection("usuarios").doc(uid);
      const snap = await ref.get();
      if (!snap.exists) return false;

      const data = snap.data();
      const creditos = data.creditos || 0;

      if (creditos >= costo) {
        await ref.update({ creditos: creditos - costo });
        return true;
      } else {
        mostrarModal("❌ Créditos insuficientes.");
        return false;
      }
    }

    form.addEventListener("submit", async e => {
      e.preventDefault();

      const ubicacion = document.getElementById("ubicacion").value;
      const usuario = document.getElementById("usuario").value;
      const password = document.getElementById("password").value;
      const dias = parseInt(document.getElementById("dias").value);
      const limite = parseInt(document.getElementById("limite").value);

      if (dias > 30 || limite > 500) {
        mostrarModal("❌ Límite excedido.");
        return;
      }

      let costo = 0;
      let resultado = "";

      if (ubicacion === "estados-unidos") {
        costo = 3;
        resultado = `Procesando datos...<div class="spinner"></div>`;
        mostrarModal(resultado);
        await new Promise(r => setTimeout(r, 3000));
        mostrarModal("Procesando créditos...<div class='spinner'></div>");
        await new Promise(r => setTimeout(r, 2000));
        const ok = await descontarCreditos(costo);
        if (!ok) return;

        mostrarModal(`🎉 Felicidades tu VPS fue creado con éxito 🎉

IP de Servidor: 137.184.106.106
Usuario: ${usuario}
Contraseña: ${password}
Días de Duración: ${dias}
Fecha de Expiración: 30/07/2025
Límite de Conexión: ${limite}

SSH: 22
DROPBEAR: 80 90
SSL: 443
SQUID: 3128
Bad VPN: 7300
Python: 100

PAYLOAD WEBSOCKET:
GET / HTTP/1.1[crlf]Host: 137.184.106.106[crlf]Upgrade: websocket[crlf][crlf]`);

      } else if (ubicacion === "peru") {
        costo = 9;
        const ok = await descontarCreditos(costo);
        if (!ok) return;

        mostrarModal(`🔐 VPS LIBRE REGALO 🎉🎁

👽 IP del Servidor:
kevin.golbert-vps.fun
👥 Usuario: regalo
🗝️ Contraseña: regalo
🏷️ Duración: 30 días

-------------------- payload --------------------
GET / HTTP/1.1[crlf]Host: kevin.golbert-vps.site[crlf]Connection: Keep-Alive[crlf]User-Agent: [ua][crlf]Upgrade: websocket[crlf][crlf]

🗓️ Fecha de Expiración: 30 días
🔒 Límite de Conexión: 100
🌐 Compatible con:
🎮 Juegos online
🍿 Netflix
🎞️ Llamadas
🕹️ Redes sociales
📥 Descargas
💯 Créditos: @servidoresvidaltecnet5`);
        
      } else if (ubicacion === "aleatorio") {
        costo = 6;
        const ok = await descontarCreditos(costo);
        if (!ok) return;

        mostrarModal(`◈─────⪧ IMPORTANT ⪦──────◈
◈⪧ 🚫 NO SPAM
◈⪧ ⚠️ NO DDOS
◈⪧ 🎭 NO Hacking
◈⪧ ⛔ NO Carding
◈⪧ 🙅‍♂️ NO Torrent

🐉 DRAGON VPS MANAGER 🐉

◈ Host: 176.100.39.110
◈ Usuario: test
◈ Contraseña: 1234
◈ Límite: 99
◈ Expira: 27/06/2025

◈ SSH: 22 | SSL: 443 | Squid: 8080 | DropBear: 80 | BadVPN: 7300

◈ Online: http://176.100.39.110:8888/server/online
dns.blackoftcloud.site

©️ DRAGON VPS`);
      } else {
        mostrarModal("Selecciona una ubicación válida.");
      }
    });
  </script>
</body>
    </html>
